---
title: 对象的引用计数是如何管理的
date: 2019-05-06 22:34:14
tags: objc iOS OC 
---

# 问题
1. iOS如何管理内存
2. 对象的引用计数是如何管理的 
    * 对象的引用计数保存在哪里
    * 对象的引用计数是如何修改的
iOS采用自动释放池技术和ARC技术管理堆内存
<!-- 此处解释app的内存分区 插入图片  -->
<!-- 如何管理堆上的内存 -->
## ARC 
   ARC的全称是AutoReleaseConference自动引用计数 区别于MRC,程序员不需要手动释放，
   * 对于实例变量，编译器会在合适的位置插入内存管理语句
   * 对于临时变量，采用自动释放池技术管理对象的引用计数
   
## autoreleasepool
   autoreleasepool也就是前文提到的自动释放池技术，详情可参考[自动释放池的原理](http://blog.kaolagogogo.fun/2018/11/26/%E8%87%AA%E5%8A%A8%E9%87%8A%E6%94%BE%E6%B1%A0%E7%9A%84%E5%8E%9F%E7%90%86/)

## 管理对象的引用计数
### 问题


### 对象的生命周期

* 生成&持有对象（rc+1）objc initialize(alloc/new/copy/mutableCopy) 
* 持有对象（rc+1）objc retain 
* 释放对象（rc-1）objc release 
* 废弃对象（rc==0）objc dealloc 

* 前面提到的关于引用计数的主要问题是：`对象的引用计数保存在哪里`和`对象的引用计数是如何修改的`
查看objc的源码(我的版本是723，现在有[更新的](https://opensource.apple.com/source/objc4/))
* 找到对象生成、持有、释放时候调用的api
####  生成&持有对象 

#### 持有对象 retain

#### 释放对象 release

### 总结一下






